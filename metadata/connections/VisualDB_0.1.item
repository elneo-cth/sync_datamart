<?xml version="1.0" encoding="UTF-8"?>
<xmi:XMI xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:TalendMetadata="http://www.talend.org/metadata/connection/2010" xmlns:orgomg.cwm.foundation.softwaredeployment="http:///orgomg/cwm/foundation/softwaredeployment.ecore" xmlns:orgomg.cwm.resource.relational="http:///orgomg/cwm/resource/relational.ecore">
  <TalendMetadata:DatabaseConnection xmi:id="_7KmzMPgdEeGMdKi780LSMQ" name="VisualDB" label="VisualDB" component="_7OQkIPgdEeGMdKi780LSMQ" dataPackage="_7OMSsPgdEeGMdKi780LSMQ" DatabaseType="Microsoft SQL Server" DriverClass="net.sourceforge.jtds.jdbc.Driver" URL="jdbc:jtds:sqlserver://10.0.0.4:1433/Tec;instance=TECHNOFLUID" dbVersionString="V5R4 to V6R1" Port="1433" Username="sa" Password="3xS5/sHJNOo=" ServerName="10.0.0.4" DatasourceName="" FileFieldName="" SID="Tec" SqlSynthax="SQL Syntax" DbmsId="id_MSSQL" ProductId="SQL_SERVER" AdditionalParams="instance=TECHNOFLUID" StandardSQL="true" SQLMode="false" UiSchema="dbo">
    <taggedValue xmi:id="_7MkiEPgdEeGMdKi780LSMQ" tag="Using URL" value="jdbc:jtds:sqlserver://10.0.0.4:1433/Tec;instance=TECHNOFLUID"/>
    <taggedValue xmi:id="_7MkiEfgdEeGMdKi780LSMQ" tag="package filter" value=""/>
    <taggedValue xmi:id="_7N1tYPgdEeGMdKi780LSMQ" tag="Status" value=""/>
    <taggedValue xmi:id="_7N1tYfgdEeGMdKi780LSMQ" tag="Version" value="0.1"/>
    <taggedValue xmi:id="_7N1tYvgdEeGMdKi780LSMQ" tag="Purpose" value=""/>
    <taggedValue xmi:id="_7N1tY_gdEeGMdKi780LSMQ" tag="Description" value=""/>
    <taggedValue xmi:id="_7N1tZPgdEeGMdKi780LSMQ" tag="Author" value=""/>
    <taggedValue xmi:id="_7N1tZfgdEeGMdKi780LSMQ" tag="otherParameter" value=""/>
    <taggedValue xmi:id="_7N3ikPgdEeGMdKi780LSMQ" tag="DB IdentifierQuoteString" value="&quot;"/>
    <queries xmi:id="_Hyp40PgeEeGMdKi780LSMQ">
      <query xmi:id="_Hyp40fgeEeGMdKi780LSMQ" name="_s" id="_TIcKECdCEeO984oflEFqmQ" label="_s" value="SELECT Year(date_cmd) AS annee, Month(date_cmd) AS mois, UPPER(CmdClient.CODE_STAT) as code_state, &#xA;UPPER(ARTICLE.FOURNISSEUR) AS FOURNISSEUR,&#xA;CASE WHEN ARTICLE.DEPARTEMENT LIKE 'TAS' THEN 'Compressors'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'TMI' THEN 'Maintenance'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'TPA' THEN 'Pneumatics'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'TPC' THEN 'Instruments'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'SERV' THEN 'Service'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'HYD' THEN 'Hydraulics' &#xD;&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'SUN' THEN 'Energy' &#xA;ELSE ARTICLE.DEPARTEMENT&#xA;END as departement,&#xA;CASE WHEN CmdClient.CODE_STAT LIKE 'AUD' OR CmdClient.CODE_STAT LIKE 'TAS' OR CmdClient.CODE_STAT LIKE 'VID' THEN 'COMP'&#xA;WHEN CmdClient.CODE_STAT LIKE 'HYD' OR CmdClient.CODE_STAT LIKE 'TPA' THEN 'PNEU' &#xA;WHEN CmdClient.CODE_STAT LIKE 'SUN' THEN 'ENER' &#xA;WHEN CmdClient.CODE_STAT LIKE 'TPC' THEN 'INST' &#xA;WHEN CmdClient.CODE_STAT LIKE 'TMI' THEN 'MAIN' &#xA;WHEN CmdClient.CODE_STAT LIKE 'COMP' THEN 'COMP'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'AUD' OR ARTICLE.DEPARTEMENT LIKE 'TAS' OR ARTICLE.DEPARTEMENT LIKE 'VID' THEN 'COMP'&#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'HYD' OR ARTICLE.DEPARTEMENT LIKE 'TPA' THEN 'PNEU' &#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'SUN' THEN 'ENER' &#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'TPC' THEN 'INST' &#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'TMI' THEN 'MAIN' &#xA;WHEN ARTICLE.DEPARTEMENT LIKE 'COMP' THEN 'COMP'&#xA;ELSE CmdClient.CODE_STAT&#xA;END AS REALDEPARTEMENT,&#xA;ARTICLE.FAMILLE, CmdClientLigne.NOARTICLE, &#xA;(convert(decimal(18,3),CmdClientLigne.QUANTITE * CASE WHEN Typedoc=4 THEN -1  ELSE 1 END)) AS QUANTITE, &#xA;CmdClient.NOCLIENT, UPPER(CmdClient.REPRESENTANT) as representant, &#xA;CASE WHEN CmdClient.Siege='Wetteren' THEN 'TF Wetteren' ELSE 'TF Awans' END AS Siege, &#xA;(convert(decimal(18,3),(quantite*prix* CASE WHEN Typedoc=4 THEN -1  ELSE 1 END * cours *((100-remise)/100)) ) -&#xA;convert(decimal(18,3),(QUANTITE*der_prix_achat* CASE WHEN famille='M-O' THEN 0 ELSE 1 END * CASE WHEN Typedoc=4 THEN -1 ELSE 1 END))) AS margin,&#xA;convert(decimal(18,3),(quantite*prix* CASE WHEN Typedoc=4 THEN -1  ELSE 1 END * cours *((100-remise)/100)) ) AS PV,&#xA;convert(decimal(18,3),(QUANTITE*der_prix_achat* CASE WHEN famille='M-O' THEN 0 ELSE 1 END * CASE WHEN Typedoc=4 THEN -1 ELSE 1 END)) AS PR, &#xA;CASE WHEN &#xA;&#x9;(QUANTITE*der_prix_achat* CASE WHEN famille='M-O' THEN 0 ELSE 1 END * CASE WHEN Typedoc=4 THEN -1 ELSE 1 END)=0&#xA;THEN 0&#xA;ELSE &#xA;&#x9;convert(decimal(18,3),(quantite*prix* CASE WHEN Typedoc=4 THEN -1  ELSE 1 END * cours *((100-remise)/100)) /&#xA;&#x9;(QUANTITE*der_prix_achat* CASE WHEN famille='M-O' THEN 0 ELSE 1 END * CASE WHEN Typedoc=4 THEN -1 ELSE 1 END))&#xA;END AS k,&#xA;CmdClient.Journal, CmdClient.NoInt_Activite, CmdClient.User_Cr, CmdClient.CMD, CmdClientLigne.NOORDRE,&#xA;date_cmd, CmdClient.TYPEDOC, CmdClient.NODOC, CmdClient.Marche,  &#xA;CASE WHEN CmdClient.NOLIVRAISON IS NOT NULL AND CmdClient.NOLIVRAISON!='' AND LIVRAISON.CODEPOST IS NOT NULL THEN&#xA;&#x9;LIVRAISON.PAYS+'_'+LIVRAISON.CODEPOST&#xA;ELSE  Clients.PAYS+'_'+Clients.CODEPO END AS codepost,&#xA;CASE WHEN &#xA;CmdClient.Journal is not null AND (CmdClient.Journal LIKE 'VL1' OR CmdClient.Journal LIKE 'VL2' OR CmdClient.Journal LIKE 'VG2' OR CmdClient.Journal LIKE 'VG1') THEN cast(1 as bit) ELSE cast(0 as bit) END as is_sale_counter&#xA;FROM ARTICLE &#xA;INNER JOIN (&#xA;&#x9;(CmdClientLigne INNER JOIN CmdClient&#xA;&#x9;&#x9;LEFT JOIN Clients on CmdClient.NOCLIENT=Clients.COMPTES&#xA;&#x9;&#x9;LEFT JOIN LIVRAISON on LIVRAISON.COMPTES=CmdClient.NOCLIENT AND LIVRAISON.NOLIVRAISON=CmdClient.NOLIVRAISON&#xA;&#x9;ON CmdClientLigne.CMDLIGNE = CmdClient.CMD) &#xA;&#x9;INNER JOIN DEVISE ON CmdClient.DEVISE = DEVISE.CODEDEVISE) &#xA;ON ARTICLE.ARTICLE = CmdClientLigne.NOARTICLE&#xA;&#xA;WHERE &#xA;CmdClientLigne.COMPTEGENERAL>='700000' And &#xA;CmdClientLigne.COMPTEGENERAL&lt;='7000080000' AND &#xA;CmdClient.CODE_STAT&lt;>'HSTAT' And CmdClient.CODE_STAT&lt;>'POUW' AND &#xA;CmdClient.Journal&lt;>'ERP' AND &#xA;(CmdClient.TYPEDOC=1 Or CmdClient.TYPEDOC=2 &#xA;Or CmdClient.TYPEDOC=3 Or CmdClient.TYPEDOC=4 Or CmdClient.TYPEDOC=22 Or CmdClient.TYPEDOC=25)"/>
      <query xmi:id="_dVTycKEWEeKgG_rT8Y8UZA" name="GetLastPODate" id="_PgSt8KEXEeKgG_rT8Y8UZA" label="GetLastPODate" value="select NOARTICLE, MAX(DATE_LIV), &#xA;Case WHEN UPPER(DEPOT_LOCALITE) LIKE 'AWANS%' THEN 1 ELSE 2 END as warehouse_id&#xA;from CmdfournLigne&#xA;LEFT JOIN DEPOT on DEPOT.DEPOT = CmdfournLigne.DEPOT&#xA;group by NOARTICLE, UPPER(DEPOT_LOCALITE)"/>
    </queries>
  </TalendMetadata:DatabaseConnection>
  <orgomg.cwm.resource.relational:Catalog xmi:id="_7OMSsPgdEeGMdKi780LSMQ" name="Tec" dataManager="_7KmzMPgdEeGMdKi780LSMQ">
    <ownedElement xsi:type="orgomg.cwm.resource.relational:Schema" xmi:id="_7OMSsfgdEeGMdKi780LSMQ" name="dbo"/>
  </orgomg.cwm.resource.relational:Catalog>
  <orgomg.cwm.foundation.softwaredeployment:Component xmi:id="_7OQkIPgdEeGMdKi780LSMQ" deployment="_7KmzMPgdEeGMdKi780LSMQ"/>
</xmi:XMI>
